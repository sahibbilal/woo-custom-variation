<?phpclass WCV_Public {	/**	 * The Name of plugin.	 *	 */	private $plugin_name;	/**	 * The Version of plugin.	 *	 */	private $version;	public function __construct( $plugin_name, $version ) {	    $this->plugin_name = $plugin_name;		$this->version = $version;	}	/**	 *Enque stylesheet.	 *	 */	public function enqueue_styles() {		wp_enqueue_style( $this->plugin_name, plugin_dir_url( __FILE__ ) . 'css/frontend.css', array(), rand(1, 100), 'all' );	}	/**	 * Register the JavaScript.	 *	 */	public function enqueue_scripts() {        wp_enqueue_script( $this->plugin_name . '-sb-jquery', plugin_dir_url( __FILE__ ) . 'js/public.js', array( 'jquery' ), $this->version , true );        wp_localize_script( $this->plugin_name . '-sb-jquery', 'ajax_url', array('ajax' => admin_url('admin-ajax.php')) );    }	/**	 * Before add to cart button hook function	 *	 */	public function sb_woocommerce_before_add_to_cart_button_function() {        global $product;	    if ( $product->is_type( 'variable' ) ) {	        ?>            <style>                .variations{                    display: none !important;                }            </style>            <?php            foreach ($product->get_variation_attributes() as $taxonomy => $term_names ) {                ?>                <div class="sb_attr_select_main sb_attr_select sb-flex" data-attr_val="" data-attribute="attribute_<?php echo $taxonomy; ?>">                    <div class="sb_select_image" data-img=""></div>                    <p style="margin-bottom: 0">                        <span><span class="sb_select_selected">Select</span> <?php echo wc_attribute_label($taxonomy); ?> (+<?php echo count($term_names)?>)</span>                        <br />                        <span class="sb_selected_var">Not Selected</span>                    </p>                    <p class="sb_arrow"></p>                </div>                <?php            }        }    }    /**     * variation details popup     *     */    public function sb_wp_footer_function() {        if ( !is_product() ){            return;        }        global $product;        if ( $product->is_type( 'variable' ) ) {            ?>            <div class="sb_load sb_page_load"><div class="sb_loader"></div></div>            <input type="hidden" value="<?php echo $product->get_id(); ?>" id="sb_main_product">            <div class="sb_variation_details_main" style="display: none">                <div class="sb_variation_details">                    <div class="sb_loader_parent"></div>                    <div class="sb_loader"></div>                    <div class="margin--large-bottom">                        <div class="sb_popup_body">                            <?php                            $sb = $sb_1 = $sb_2 = 0;                            $attrs = [];                            $attrs_exist = [];                            foreach ($product->get_available_variations() as $key => $attributes ) {                                foreach ($attributes['attributes'] as $key => $single){                                    $index = array_search($single,$attrs_exist);                                    if($attrs_exist[$index] != $single){                                        $attrs[$sb]['image'] = (!empty($attributes['image']['url'])) ? $attributes['image']['url'] : get_home_url().'/wp-content/uploads/woocommerce-placeholder-600x600.png';                                        $attrs[$sb]['thumnail'] = (!empty($attributes['image']['gallery_thumbnail_src'])) ? $attributes['image']['gallery_thumbnail_src'] : get_home_url().'/wp-content/uploads/woocommerce-placeholder-600x600.png';                                        $attrs[$sb]['attr'] = $single;                                        $attrs[$sb]['key'] = $key;                                        $sb++;                                    }                                    $attrs_exist[] = $single;                                    break;                                }                            }                            $sb = 1;                            foreach ($product->get_variation_attributes() as $taxonomy => $term_names ) {                                $attr = $product->get_attribute( $taxonomy );                                $variations = explode(',', $attr);                                $attr_name = str_replace("-"," ", str_replace("pa_","",$taxonomy));                                ?>                                <div class="sb_attr_details <?php echo ($sb == 1) ? 'sb_parent_active' : ''?>" id="attribute_<?php echo $taxonomy; ?>" style="display:none;">                                    <div class="bg-white sb-sticky sb_popup_header">                                        <h2 class="title--large padding--small">Select a <?php echo $attr_name; ?></h2>                                        <button class="l-popin-close sb-popin-close">                                            <i class="fas fa-times"></i>                                            <span class="visually-hidden">Close</span>                                        </button>                                    </div><!--                                    <p class="sb_attr_title">Select a --><?php //echo $attr_name; ?><!--</p>-->                                    <div class="sb_filters_main">                                        <?php                                        $sb_2++;                                        if($sb_2 == 1){                                            ?>                                            <div class="sb_main_filter sb_active_filter" data-target="all">                                                All <?php echo $attr_name; ?>                                            </div>                                            <?php                                            foreach ($attrs as $key => $attr) {                                                $single = $attr['attr'];                                                $attr_val = str_replace("-"," ",$single);                                                ?>                                                <div class="sb_main_filter" data-target="<?php echo $single; ?>">                                                    <?php echo ucwords($attr_val); ?>                                                </div>                                                <?php                                            }                                        }                                        ?>                                    </div>                                    <div class="variation_details" data-attribute="attribute_<?php echo trim($taxonomy); ?>">                                        <?php                                        $sb_2++;                                        if($sb_2 == 2)                                        foreach ($attrs as $key => $attr){                                            $sb_1++;                                            $single = $attr['attr'];                                            $attr_val = str_replace("-"," ",$single);                                            if(count($variations) >= 2 && $sb_1 == 1){                                                $class = 'sb_active';                                            }else{                                                $class = '';                                            }                                            ?>                                            <div class="variation_details_a <?php echo $single.' '.$class; ?>" data-attribute="<?php echo $attr['key']; ?>" data-attr_val="<?php echo $single; ?>" class="sb_select_attr" data-value="<?php echo ucwords($attr_val); ?>" data-img="<?php echo $attr['thumnail'];?>">                                                <img src="<?php echo $attr['image'];?>">                                                <p><?php echo ucwords($attr_val); ?></p>                                            </div>                                            <?php                                        }                                        ?>                                    </div>                                </div>                                <?php                                $sb++;                            }                            ?>                        </div>                    </div>                </div>            </div>            <?php        }    }    /**     * variation details popup     *     */    function sb_get_variation_id() {        $product    = wc_get_product($_POST['id']);        $vars       = $_POST['variations'];        $attrs      = $_POST['attributes'];        $type       = $_POST['type'];        $variations = $product->get_available_variations();        $quan       = count($attrs);        $request    = $res  = $values = $keys = [];        for ($i = 0; $i < $quan; $i++) {            $request[$attrs[$i]] = ltrim($vars[$i], '-');        }        if($type == 'click') {            foreach ($variations as $variation) {                $result = array_diff($variation['attributes'], $request);                if (count($result) == 0) {                    echo $variation['variation_id'];                    die();                }            }            $res['code'] = 2.01;        }        else{            $res['code'] = 2.02;            $count = 0;            foreach ($variations as $variation) {                foreach ($variation['attributes'] as $key => $single){                    $result = array_diff($variation['attributes'], $request);                    if(count($variation['attributes']) > count($result)){                        $searched = array_search($key, $attrs);                        if($attrs[$searched] != $key){                            $keys[] = $key;                            $values[] = $variation['attributes'][$key];                        }                    }                }            }        }        echo json_encode($res, true);        die();    }    /**     * variation details popup     *     */    function sb_get_variations() {        $main_attr      = $_POST['main_attr'];        $main_attr_val  = $_POST['main_attr_val'];        $current_attr   = $_POST['current_attr'];        $pro_id         = $_POST['pro_id'];        $product    = wc_get_product($pro_id);        $variations = $product->get_available_variations();        $selected = [];        foreach ($variations as $variation) {            if($variation['attributes'][$main_attr] == $main_attr_val){                $selected[] = $variation['attributes'][$current_attr];            }        }        echo json_encode(array_unique($selected), true);        die();    }}